<script>
  const fileInput = document.getElementById('uploadPhotos');
  const previewArea = document.getElementById('previewArea');
  const fileCountEl = document.getElementById('fileCount');

  fileInput.addEventListener('change', () => {
    const files = Array.from(fileInput.files);

    // バリデーション：最大5枚
    if (files.length > 5) {
      alert('写真は最大5枚までアップロードできます。先頭の5枚のみを表示します。');
    }
    const limited = files.slice(0, 5);

    // 個数表示更新
    fileCountEl.textContent = `${limited.length} 枚`;

    // プレビュー初期化
    previewArea.innerHTML = '';

    // プレビュー生成
    limited.forEach((file, idx) => {
      if (!file.type.startsWith('image/')) return; // 画像以外は無視

      const reader = new FileReader();
      reader.onload = e => {
        const card = document.createElement('div');
        const img = document.createElement('img');
        const badge = document.createElement('div');

        card.className = 'preview-card';
        img.src = e.target.result;
        img.alt = `アップロード画像 ${idx + 1}枚目`;
        badge.className = 'preview-badge';
        badge.textContent = `${idx + 1} 枚目`;

        card.appendChild(img);
        card.appendChild(badge);
        previewArea.appendChild(card);
      };
      reader.readAsDataURL(file);
    });
  });
</script>
